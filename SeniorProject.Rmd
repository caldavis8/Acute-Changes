---
title: "Senior Project"
author: "Calvin Davis"
date: "10/24/2021"
output: word_document
---
```{r}
install.packages("tidyverse")
install.packages("lme4")
install.packages("ggpubr")

```

```{r}
library(ggplot2)
library(tidyr)
library(ggpubr)

setwd("~/Senior Project")
```

```{r}
names(calibration_data)
```
```{r}
View(thermocouple1)
```


##Thermocouple calibration

```{r}
calibration_data <- read.csv("Thermocouple calibration data.csv", header = TRUE)
```


```{r}
ggplot() +
   geom_point(data=calibration_data, 
         aes(x= calibration_data$ï..Place, y = calibration_data$reference_temp1), 
         color = "black") +
   geom_point(data=calibration_data, 
         aes(x=calibration_data$ï..Place, y = calibration_data$Value_E), 
         color = "blue") +
   theme_classic() 
  # scale_x_continuous(limits = c(50,150), breaks=seq(0,150, 10)) 
   
   
```

##Calibrating Thermocouples

```{r}
##can be fitted to any of the thermocouples to visualize the calibration curve
ggplot(calibration_data, #graphs thermocouple temp for lead E x reference thermometer temp
      aes(x = Value_E, y = reference_temp1)) +
      geom_point() +
      geom_smooth(method = "lm", se = TRUE) +
      theme_classic() +
      stat_regline_equation() #displays the regression line equation

```


##I have been trying for ages to automate this process instead of manually assembling calibration curves but for the life of me I can't seem to get it

Thermocouple E
```{r}
regression_e <- lm(calibration_data$reference_temp1~calibration_data$Value_E)
coef(regression_e)
```
## y =  1.011570x - 1.641703


Thermocouple B
```{r}
regression_b <- lm(calibration_data$reference_temp1~calibration_data$Value_B)
coef(regression_b)
```
## y = 1.018007 - 1.671978

Thermocouple H
```{r}
regression_h <- lm(calibration_data$reference_temp1~calibration_data$Value_H)
coef(regression_h)
```
## y =  1.035925x - 1.852796

Thermocouple A
```{r}
regression_a <- lm(calibration_data$reference_temp2~calibration_data$Value_A)
coef(regression_a)
```
## y = 1.010286x - 1.618859

Thermocouple D
```{r}
regression_d <- lm(calibration_data$reference_temp2~calibration_data$Value_D)
coef(regression_d)
```
## y = 1.008465x - 1.621470

Thermocouple F
```{r}
regression_f <- lm(calibration_data$reference_temp2~calibration_data$Value_F)
coef(regression_f)
```
## y = 1.009847x - 1.700887

Thermocouple C
```{r}
regression_c <- lm(calibration_data$reference_temp2~calibration_data$Value_E)
coef(regression_c)
```
## y = 1.451494x - 3.962454     we decided not to use this thermocouple









##Raw Plot of All Data
```{r}
aquaflux <- read.csv("AquaFluxData.csv", header = TRUE)

```

```{r}
names(aquaflux)
```



Raw Plot
```{r}
ggplot(aquaflux) +
       aes(aquaflux$Time_sec, aquaflux$Flux_g.m2h, color = aquaflux$Treatment) +
       geom_point(size = 0.01) +
       theme_classic() +
       scale_color_manual(values = c("Control" = "snow4","Cooling" = "steelblue3",  "Heating"="orange")) +
       labs(x= "Time (sec)" , y= "Flux (g/m^2hr)", color ="Treatment", se = FALSE) 

       #geom_smooth( 
           # aes(aquaflux$Time_sec, aquaflux$Flux_g.m2h, color = aquaflux$Treatment, method = "lm")) 
      # scale_x_continuous(limits = c(0,16), breaks=seq(0,20, 2)) +
       #scale_y_continuous(limits = c(0,7), breaks=seq(0,7, 1))
      #alpha = number controls transparency
```

